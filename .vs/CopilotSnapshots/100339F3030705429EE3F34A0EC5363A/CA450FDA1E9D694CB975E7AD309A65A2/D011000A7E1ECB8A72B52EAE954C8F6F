using System.ComponentModel.DataAnnotations;
using System.ComponentModel.DataAnnotations.Schema;

namespace CMS.Entities
{
    [Table("user", Schema = "admin")]
    public class User : IAuditableEntity
    {
        [Key]
        [Column("id_user")]
        public int ID_USER { get; set; }

        [Column("user_name")]
        [Required]
        [MaxLength(100)]
        public string USER_NAME { get; set; } = default!;

        [Column("azure_oid")]
        public Guid? AZURE_OID { get; set; }

        [Column("email")]
        [Required]
        [MaxLength(255)]
        public string EMAIL { get; set; } = default!;

        [Column("password_hash")]
        [MaxLength(255)]
        public string? PASSWORD_HASH { get; set; }

        [Column("azure_upn")]
        [MaxLength(255)]
        public string? AZURE_UPN { get; set; }

        [Column("display_name")]
        [Required]
        [MaxLength(255)]
        public string DISPLAY_NAME { get; set; } = default!;

        [Column("id_country")]
        public int ID_COUNTRY { get; set; }

        [Column("id_gender")]
        public int ID_GENDER { get; set; }

        [Column("first_name")]
        [Required]
        [MaxLength(50)]
        public string FIRST_NAME { get; set; } = default!;

        [Column("last_name")]
        [Required]
        [MaxLength(50)]
        public string LAST_NAME { get; set; } = default!;

        [Column("phone_number")]
        [Required]
        [MaxLength(15)]
        public string PHONE_NUMBER { get; set; } = default!;

        [Column("time_zone")]
        [Required]
        [MaxLength(50)]
        public string TIME_ZONE { get; set; } = default!;

        [Column("id_language")]
        public int ID_LANGUAGE { get; set; } = 1832;

        [Column("is_email_verified")]
        public bool IS_EMAIL_VERIFIED { get; set; }

        [Column("is_phone_verified")]
        public bool IS_PHONE_VERIFIED { get; set; }

        [Column("failed_login_attempts")]
        public int FAILED_LOGIN_ATTEMPTS { get; set; }

        [Column("lockout_end")]
        public DateTime? LOCKOUT_END { get; set; }

        [Column("password_reset_token")]
        [MaxLength(255)]
        public string? PASSWORD_RESET_TOKEN { get; set; }

        [Column("password_reset_token_expiry")]
        public DateTime? PASSWORD_RESET_TOKEN_EXPIRY { get; set; }

        [Column("email_verification_token")]
        [MaxLength(255)]
        public string? EMAIL_VERIFICATION_TOKEN { get; set; }

        [Column("email_verification_token_expiry")]
        public DateTime? EMAIL_VERIFICATION_TOKEN_EXPIRY { get; set; }

        [Column("last_login")]
        public DateTime? LAST_LOGIN { get; set; }

        [Column("last_password_change")]
        public DateTime? LAST_PASSWORD_CHANGE { get; set; }

        [Column("date_of_birth")]
        public DateTime DATE_OF_BIRTH { get; set; }

        [Column("login_count")]
        public int LOGIN_COUNT { get; set; }

        [Column("last_login_ip")]
        [MaxLength(50)]
        public string? LAST_LOGIN_IP { get; set; }

        [Column("is_active")]
        public bool IS_ACTIVE { get; set; } = true;

        [Column("rowpointer")]
        public Guid RowPointer { get; set; }

        [Column("record_date")]
        public DateTime RecordDate { get; set; }

        [Column("createdate")]
        public DateTime CreateDate { get; set; }

        [Column("created_by")]
        [Required]
        [MaxLength(30)]
        public string CreatedBy { get; set; } = default!;

        [Column("updated_by")]
        [Required]
        [MaxLength(30)]
        public string UpdatedBy { get; set; } = default!;

        // ⭐ PROPIEDADES DE NAVEGACIÓN - MARCADAS COMO [NotMapped] TEMPORALMENTE
        [NotMapped]
        public virtual Language Language { get; set; } = default!;

        [NotMapped]
        public virtual Country Country { get; set; } = default!;

        [NotMapped]
        public virtual Gender Gender { get; set; } = default!;

        public virtual ICollection<UserRole> UserRoles { get; set; } = new List<UserRole>();
        public virtual ICollection<RolePermission> RolePermissions { get; set; } = new List<RolePermission>();
        public virtual ICollection<UserPermission> UserPermissions { get; set; } = new List<UserPermission>();
    }
}